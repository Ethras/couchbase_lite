<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, user-scalable=no">
  <meta name="generator" content="made with love by dartdoc 0.28.1+2">
  <meta name="description" content="couchbase_lite API docs, for the Dart programming language.">
  <title>couchbase_lite - Dart API docs</title>

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500,400i,400,300|Source+Sans+Pro:400,300,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="static-assets/github.css">
  <link rel="stylesheet" href="static-assets/styles.css">
  <link rel="icon" href="static-assets/favicon.png">
  
</head>

<body>

<div id="overlay-under-drawer"></div>

<header id="title">
  <button id="sidenav-left-toggle" type="button">&nbsp;</button>
  <ol class="breadcrumbs gt-separated dark hidden-xs">
    <li><a href="https://github.com/bawelter/couchbase_lite">couchbase_lite package</a></li>
  </ol>
  <div class="self-name">couchbase_lite</div>
  <form class="search navbar-right" role="search">
    <input type="text" id="search-box" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
  </form>
</header>

<main>

  <div id="dartdoc-sidebar-left" class="col-xs-6 col-sm-3 col-md-2 sidebar sidebar-offcanvas-left">
    <header id="header-search-sidebar" class="hidden-l">
      <form class="search-sidebar" role="search">
        <input type="text" id="search-sidebar" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
      </form>
    </header>
    
    <ol class="breadcrumbs gt-separated dark hidden-l" id="sidebar-nav">
      <li><a href="https://github.com/bawelter/couchbase_lite">couchbase_lite package</a></li>
    </ol>
    
    <h5 class="hidden-xs"><span class="package-name">couchbase_lite</span> <span class="package-kind">package</span></h5>
    <ol>
          <li class="section-title">Libraries</li>
          <li><a href="couchbase_lite/couchbase_lite-library.html">couchbase_lite</a></li>
          <li class="section-title">Dart</li>
          <li><a href="dart-ui/dart-ui-library.html">dart:ui</a></li>
          <li class="section-subtitle">Core</li>
            <li class="section-subitem"><a href="dart-async/dart-async-library.html">dart:async</a></li>
            <li class="section-subitem"><a href="dart-collection/dart-collection-library.html">dart:collection</a></li>
            <li class="section-subitem"><a href="dart-convert/dart-convert-library.html">dart:convert</a></li>
            <li class="section-subitem"><a href="dart-core/dart-core-library.html">dart:core</a></li>
            <li class="section-subitem"><a href="dart-developer/dart-developer-library.html">dart:developer</a></li>
            <li class="section-subitem"><a href="dart-math/dart-math-library.html">dart:math</a></li>
            <li class="section-subitem"><a href="dart-typed_data/dart-typed_data-library.html">dart:typed_data</a></li>
          <li class="section-subtitle">VM</li>
            <li class="section-subitem"><a href="dart-io/dart-io-library.html">dart:io</a></li>
            <li class="section-subitem"><a href="dart-isolate/dart-isolate-library.html">dart:isolate</a></li>
    </ol>
  </div>

  <div id="dartdoc-main-content" class="col-xs-12 col-sm-9 col-md-8 main-content">
      <section class="desc markdown">
        <h1 id="couchbase_lite-plugin">couchbase_lite plugin</h1>
<p><a href="https://travis-ci.org/bawelter/couchbase_lite"><img alt="Build Status" src="https://travis-ci.org/bawelter/couchbase_lite.svg?branch=master"></a>
<a href="https://coveralls.io/github/bawelter/couchbase_lite?branch=master"><img alt="Coverage Status" src="https://coveralls.io/repos/github/bawelter/couchbase_lite/badge.svg?branch=master"></a>
<a href="https://pub.dartlang.org/packages/couchbase_lite"><img alt="pub package" src="https://img.shields.io/pub/v/couchbase_lite.svg"></a></p>
<p>A Flutter plugin for Couchbase Lite Community Edition. An embedded lightweight, noSQL database with live synchronization and offline support on Android and iOS.</p>
<p>The goal of this project is to align this library with the <a href="https://docs.couchbase.com/mobile/2.5.0/couchbase-lite-swift/">Swift SDK API</a> for Couchbase Lite.</p>
<p><em>Note</em>: This plugin is still under development, and some APIs might not be available yet.
<a href="https://github.com/bawelter/couchbase_lite/issues">Feedback</a> and <a href="https://github.com/bawelter/couchbase_lite/pulls">Pull Requests</a> are most welcome!</p>
<p>This project forked from <a href="https://github.com/oltrenuovefrontiere/fluttercouch">Fluttercouch</a></p>
<h2 id="getting-started">Getting Started</h2>
<p>In your flutter project add the dependency:</p>
<pre class="language-yaml"><code class="language-yaml">dependencies:
  couchbase_lite: ^2.5.1+3
  
  flutter:
      sdk: flutter
</code></pre>
<p>For help getting started with Flutter, view the 
<a href="https://flutter.dev/docs">online documentation</a></p>
<h2 id="supported-versions">Supported Versions</h2>
<h3 id="ios">iOS</h3><table><thead><tr><th>Platform</th><th>Minimum OS version</th></tr></thead><tbody><tr><td>iOS</td><td>9.0</td></tr></tbody></table>
<h3 id="android">Android</h3><table><thead><tr><th>Platform</th><th>Runtime architectures</th><th>Minimum API Level</th></tr></thead><tbody><tr><td>Android</td><td>armeabi-v7a</td><td>19</td></tr><tr><td>Android</td><td>arm64-v8a</td><td>21</td></tr><tr><td>Android</td><td>x86</td><td>19</td></tr></tbody></table>
<h2 id="api-references">API References</h2>
<p><a href="https://docs.couchbase.com/mobile/2.5.0/couchbase-lite-swift/">Swift SDK API References</a></p>
<p><a href="http://docs.couchbase.com/mobile/2.5.0/couchbase-lite-java">Java SDK API References</a></p>
<p><em>Note</em>: Syntax follows the Swift SDK but these are the SDKs used for the platform code.</p>
<h2 id="usage-example">Usage example</h2>
<p>Below is an example for the database using the BLoC pattern ( View &lt;-&gt; BLoC &lt;-&gt; Repository &lt;-&gt; Database )</p>
<p>The files can also be found in the plugin example but are not used in the main.dart.  The example will be revised in the near future to use the BLoC pattern.</p>
<pre class="language-dart"><code class="language-dart">class AppDatabase {
  static final AppDatabase instance = AppDatabase._internal();

  AppDatabase._internal();

  String dbName = "myDatabase";
  List&lt;Future&gt; pendingListeners = List();
  ListenerToken _replicatorListenerToken;
  Database database;
  Replicator replicator;

  Future&lt;bool&gt; login(String username, String password) async {
    try {
      database = await Database.initWithName(dbName);
      // Note wss://10.0.2.2:4984/my-database is for the android simulator on your local machine's couchbase database
      ReplicatorConfiguration config = ReplicatorConfiguration(database, "wss://10.0.2.2:4984/my-database");
      config.replicatorType = ReplicatorType.pushAndPull;
      config.continuous = true;

      // Using self signed certificate
      config.pinnedServerCertificate = "assets/cert-android.cer";
      config.authenticator = BasicAuthenticator(username, password);
      replicator = Replicator(config);

      replicator.addChangeListener((ReplicatorChange event) {
        if (event.status.error != null) {
          print("Error: " + event.status.error);
        }

        print(event.status.activity.toString());
      });

      replicator.start();
      return true;
    } on PlatformException {
      return false;
    }
  }

  Future&lt;void&gt; logout() async {
    await Future.wait(pendingListeners);
    replicator.removeChangeListener(_replicatorListenerToken);
    _replicatorListenerToken = replicator.addChangeListener((ReplicatorChange event) async {
      if (event.status.activity == ReplicatorActivityLevel.stopped) {
        await database.close();
        replicator.removeChangeListener(_replicatorListenerToken);
        _replicatorListenerToken = null;
      }
    });
    await replicator.stop();
  }

  Future&lt;Map&lt;String,dynamic&gt;&gt; createDocument(Map&lt;String,dynamic&gt; map) async {
    var id = "mydocument::${Uuid().v1()}";

    try {
      String documentId = await database.saveDocumentWithId(id, Document(map));
      var newDoc = Map.from(map);
      newDoc["id"] = documentId;
      return newDoc;
    } on PlatformException {
      return null;
    }
  }

  ObservableResponse&lt;ResultSet&gt; getMyDocument(String documentId) {
    final stream = BehaviorSubject&lt;ResultSet&gt;();
    // Execute a query and then post results and all changes to the stream

    final Query query = QueryBuilder
        .select([
      SelectResult.expression(Meta.id.from("mydocs")).As("id"),
      SelectResult.expression(Expression.property("foo").from("mydocs")),
      SelectResult.expression(Expression.property("bar").from("mydocs")),
    ])
        .from(dbName, as: "mydocs")
        .where(Meta.id.from("mydocs").equalTo(Expression.string(documentId))
    );

    final processResults = (ResultSet results) {
      if (!stream.isClosed) {
        stream.add(results);
      }
    };

    return _buildObservableQueryResponse(stream, query, processResults);
  }

  ObservableResponse&lt;T&gt; _buildObservableQueryResponse&lt;T&gt;(BehaviorSubject&lt;T&gt; subject, Query query, ResultSetCallback resultsCallback) {
    final futureToken = query.addChangeListener((change) {
      if (change.results != null) {
        resultsCallback(change.results);
      }
    });

    final removeListener = () {
      final newFuture = futureToken.then((token) async {
        if (token != null) {
          await query.removeChangeListener(token);
        }
      });

      pendingListeners.add(newFuture);
      newFuture.whenComplete((){pendingListeners.remove(newFuture);});
    };

    try {
      query.execute().then(resultsCallback);
    } on PlatformException {
      removeListener();
      rethrow;
    }

    return ObservableResponse&lt;T&gt;(subject.debounce(Duration(seconds: 1)), () {
      removeListener();
      subject.close();
    });
  }
}
</code></pre>
<pre class="language-dart"><code class="language-dart">class ObservableResponse&lt;T&gt; {
  final Observable&lt;T&gt; result;
  final VoidFunc onDispose;
  ObservableResponse(this.result,this.onDispose);

  void dispose() {
    if (onDispose != null) {
      // Do operations here like closing streams and removing listeners
      onDispose();
    }
  }
}
</code></pre>
      </section>
      
        <section class="summary">
            <h2>Libraries</h2>
          <dl>
            <dt id="couchbase_lite">
              <span class="name"><a href="couchbase_lite/couchbase_lite-library.html">couchbase_lite</a></span>             
            </dt>
            <dd>
              
            </dd>          </dl>
        </section>
        <section class="summary">
            <h2>Dart</h2>
          <dl>
            <dt id="dart:ui">
              <span class="name"><a href="dart-ui/dart-ui-library.html">dart:ui</a></span>             
            </dt>
            <dd>
              Built-in types and core primitives for a Flutter application. <a href="dart-ui/dart-ui-library.html">[...]</a>
            </dd>            <h3>Core</h3>
              <dt id="dart:async">
                <span class="name"><a href="dart-async/dart-async-library.html">dart:async</a></span>               
              </dt>
              <dd>
                Support for asynchronous programming,
with classes such as Future and Stream. <a href="dart-async/dart-async-library.html">[...]</a>
              </dd>              <dt id="dart:collection">
                <span class="name"><a href="dart-collection/dart-collection-library.html">dart:collection</a></span>               
              </dt>
              <dd>
                Classes and utilities that supplement the collection support in dart:core. <a href="dart-collection/dart-collection-library.html">[...]</a>
              </dd>              <dt id="dart:convert">
                <span class="name"><a href="dart-convert/dart-convert-library.html">dart:convert</a></span>               
              </dt>
              <dd>
                Encoders and decoders for converting between different data representations,
including JSON and UTF-8. <a href="dart-convert/dart-convert-library.html">[...]</a>
              </dd>              <dt id="dart:core">
                <span class="name"><a href="dart-core/dart-core-library.html">dart:core</a></span>               
              </dt>
              <dd>
                Built-in types, collections,
and other core functionality for every Dart program. <a href="dart-core/dart-core-library.html">[...]</a>
              </dd>              <dt id="dart:developer">
                <span class="name"><a href="dart-developer/dart-developer-library.html">dart:developer</a></span>               
              </dt>
              <dd>
                Interact with developer tools such as the debugger and inspector. <a href="dart-developer/dart-developer-library.html">[...]</a>
              </dd>              <dt id="dart:math">
                <span class="name"><a href="dart-math/dart-math-library.html">dart:math</a></span>               
              </dt>
              <dd>
                Mathematical constants and functions, plus a random number generator. <a href="dart-math/dart-math-library.html">[...]</a>
              </dd>              <dt id="dart:typed_data">
                <span class="name"><a href="dart-typed_data/dart-typed_data-library.html">dart:typed_data</a></span>               
              </dt>
              <dd>
                Lists that efficiently handle fixed sized data
(for example, unsigned 8 byte integers) and SIMD numeric types. <a href="dart-typed_data/dart-typed_data-library.html">[...]</a>
              </dd>            <h3>VM</h3>
              <dt id="dart:io">
                <span class="name"><a href="dart-io/dart-io-library.html">dart:io</a></span>               
              </dt>
              <dd>
                File, socket, HTTP, and other I/O support for non-web applications. <a href="dart-io/dart-io-library.html">[...]</a>
              </dd>              <dt id="dart:isolate">
                <span class="name"><a href="dart-isolate/dart-isolate-library.html">dart:isolate</a></span>               
              </dt>
              <dd>
                Concurrent programming using <em>isolates</em>:
independent workers that are similar to threads
but don't share memory,
communicating only via messages. <a href="dart-isolate/dart-isolate-library.html">[...]</a>
              </dd>          </dl>
        </section>

  </div> <!-- /.main-content -->

  <div id="dartdoc-sidebar-right" class="col-xs-6 col-sm-6 col-md-2 sidebar sidebar-offcanvas-right">
  </div>

</main>

<footer>
  <span class="no-break">
    couchbase_lite 2.5.1+4
  </span>

  
</footer>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="static-assets/typeahead.bundle.min.js"></script>
<script src="static-assets/highlight.pack.js"></script>
<script src="static-assets/URI.js"></script>
<script src="static-assets/script.js"></script>


</body>

</html>
